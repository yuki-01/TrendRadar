
    <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>热点新闻分析 · TrendRadar</title>

  <!-- html2canvas 保留，供“保存为图片/分段保存”使用 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <style>
    :root{
      /* 可在这里调整主题色与模糊强度 */
      --bg-grad-1: #edf1f7;
      --bg-grad-2: #e9eef8;
      --glass-bg: rgba(255,255,255,0.58);
      --glass-dark: rgba(10,10,14,0.6);
      --glass-border: rgba(255,255,255,0.35);
      --blur: 14px;

      --text-strong: #0f172a; /* 黑色系 */
      --text-normal: #1f2937;
      --text-muted: #6b7280;
      --text-invert: #ffffff; /* 白色 */

      --primary: #2563eb; /* 链接与交互蓝 */
      --primary-visited: #7c3aed; /* 已读紫 */
      --hot: #ef4444;
      --warm: #f59e0b;
      --ok: #10b981;

      --card-gap: 16px;
      --radius: 14px;
      --container-w: 1200px; /* 宽屏最大宽度 */
      --column-gap: 16px;
      --section-gap: 18px;
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color: var(--text-normal);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC","Hiragino Sans GB","Microsoft YaHei", sans-serif;
      line-height: 1.5;
      background:
        radial-gradient(1200px 800px at 10% -10%, #e0e7ff 0%, transparent 50%),
        radial-gradient(1100px 700px at 110% 0%, #fce7f3 0%, transparent 45%),
        radial-gradient(900px 900px at 50% 120%, #dcfce7 0%, transparent 45%),
        linear-gradient(180deg, var(--bg-grad-1), var(--bg-grad-2));
      background-attachment: fixed;
    }

    /* 顶部导航（透明模糊） */
    .navbar{
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: saturate(140%) blur(var(--blur));
      -webkit-backdrop-filter: saturate(140%) blur(var(--blur));
      background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.4));
      border-bottom: 1px solid var(--glass-border);
    }
    .nav-inner{
      max-width: var(--container-w);
      margin: 0 auto;
      padding: 10px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .brand{
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      color: var(--text-strong);
      letter-spacing: 0.2px;
    }
    .brand-mark{
      width: 28px; height: 28px; border-radius: 9px;
      background: linear-gradient(135deg,#8b5cf6,#06b6d4);
      box-shadow: 0 4px 16px rgba(99,102,241,0.35);
    }

    .nav-spacer{ flex: 1; }

    .nav-links{
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .nav-link{
      padding: 8px 12px;
      border-radius: 10px;
      color: var(--text-strong);
      text-decoration: none;
      font-weight: 600;
      transition: background .2s ease, transform .15s ease;
    }
    .nav-link:hover{
      background: rgba(0,0,0,0.06);
      transform: translateY(-1px);
    }
    .nav-link.primary{
      color: var(--text-invert);
      background: linear-gradient(135deg,#2563eb,#7c3aed);
      box-shadow: 0 6px 18px rgba(37,99,235,.35);
    }
    .nav-link.primary:hover{ filter: brightness(1.03); }

    /* 移动端菜单按钮 */
    .nav-toggle{
      display: none;
      width: 38px; height: 38px;
      border-radius: 10px;
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      align-items: center; justify-content: center;
      color: var(--text-strong);
    }
    .nav-toggle:active{ transform: scale(.98); }
    .nav-mobile{
      display: none;
      padding: 8px 14px 16px;
      border-top: 1px solid var(--glass-border);
      background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.35));
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
    }
    .nav-mobile a{
      display: block;
      text-decoration: none;
      color: var(--text-strong);
      font-weight: 600;
      padding: 10px 10px;
      border-radius: 10px;
    }
    .nav-mobile a:hover{
      background: rgba(0,0,0,0.06);
    }

    /* 顶部信息+操作区（玻璃卡片） */
    .page-wrap{
      max-width: var(--container-w);
      margin: 16px auto;
      padding: 0 14px 20px;
    }
    .header-card{
      position: relative;
      border-radius: var(--radius);
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      padding: 16px 16px;
      box-shadow: 0 6px 24px rgba(0,0,0,.06);
      margin-top: 10px;
    }
    .header-top{
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .title{
      font-size: 20px;
      font-weight: 800;
      color: var(--text-strong);
      letter-spacing: .3px;
    }
    .badges{
      display: flex; gap: 8px; flex-wrap: wrap;
    }
    .badge{
      font-size: 12px;
      font-weight: 700;
      color: var(--text-invert);
      border-radius: 999px;
      padding: 6px 10px;
      background: linear-gradient(135deg,#0ea5e9,#6366f1);
    }
    .header-grid{
      display: grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap: 10px;
    }
    .info-box{
      border-radius: 12px;
      border: 1px dashed rgba(0,0,0,.06);
      background: rgba(255,255,255,0.55);
      padding: 10px 12px;
      min-height: 58px;
    }
    .info-label{
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }
    .info-value{
      font-size: 16px; font-weight: 800; color: var(--text-strong);
    }

    .header-actions{
      display: flex; gap: 10px; flex-wrap: wrap;
      margin-top: 12px;
    }
    .btn{
      appearance: none; border: none; cursor: pointer;
      padding: 10px 14px; border-radius: 12px;
      background: linear-gradient(135deg,#334155,#0f172a);
      color: var(--text-invert); font-weight: 700; font-size: 13px;
      box-shadow: 0 6px 18px rgba(15,23,42,.25);
      transition: transform .15s ease, filter .2s ease;
    }
    .btn:hover{ filter: brightness(1.05); transform: translateY(-1px); }
    .btn:active{ transform: translateY(0); }

    /* 主体内容：宽屏两列并列卡片（不同主题） */
    .content-grid{
      margin-top: 16px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: var(--column-gap);
    }
    @media (max-width: 1100px){
      .content-grid{ grid-template-columns: 1fr; }
    }

    /* 词组卡片（玻璃/磨砂） */
    .group-card{
      border-radius: var(--radius);
      border: 1px solid var(--glass-border);
      background: linear-gradient(180deg, rgba(255,255,255,0.42), rgba(255,255,255,0.28));
      backdrop-filter: blur(calc(var(--blur) * .9));
      -webkit-backdrop-filter: blur(calc(var(--blur) * .9));
      box-shadow: 0 6px 24px rgba(0,0,0,.06);
      padding: 14px 14px;
    }
    .group-head{
      display: flex; align-items: center; justify-content: space-between;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(0,0,0,0.06);
      margin-bottom: var(--section-gap);
    }
    .group-title{
      display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
    }
    .group-name{
      font-size: 17px;
      font-weight: 800;
      color: var(--text-strong);
    }
    .group-count{
      font-size: 12px; font-weight: 800; color: var(--text-invert);
      padding: 4px 8px;
      border-radius: 999px;
      background: linear-gradient(135deg,#64748b,#1f2937);
    }
    .group-count.hot{ background: linear-gradient(135deg,#ef4444,#f97316); }
    .group-count.warm{ background: linear-gradient(135deg,#f59e0b,#a855f7); }
    .group-index{
      font-size: 12px; color: var(--text-muted); font-weight: 600;
    }

    /* 每条新闻条目（更紧凑密度） */
    .news-item{
      display: grid;
      grid-template-columns: 28px 1fr;
      gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid rgba(0,0,0,0.05);
      position: relative;
    }
    .news-item:last-child{ border-bottom: none; }
    .news-number{
      width: 24px; height: 24px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: 800; color: var(--text-normal);
      background: rgba(15,23,42,.06);
      margin-top: 2px;
    }
    .news-meta{
      display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
      margin-bottom: 4px;
    }
    .source{
      font-size: 12px; color: var(--text-muted); font-weight: 700;
    }
    .rank-chip{
      font-size: 11px; color: var(--text-invert); font-weight: 800;
      padding: 2px 8px; border-radius: 999px;
      background: #6b7280;
    }
    .rank-chip.top{ background: var(--hot); }
    .rank-chip.high{ background: var(--warm); color: #111827; }
    .time-chip{
      font-size: 11px; color: var(--text-muted); font-weight: 600;
    }
    .count-chip{
      font-size: 11px; color: var(--ok); font-weight: 800;
    }
    .news-title{
      font-size: 15px; line-height: 1.45; color: var(--text-strong);
      margin: 0;
    }
    .news-link{
      color: var(--primary); text-decoration: none;
    }
    .news-link:hover{ text-decoration: underline; }
    .news-link:visited{ color: var(--primary-visited); }

    .tag-new{
      position: absolute; right: 0; top: 8px;
      font-size: 10px; font-weight: 900;
      color: #92400e;
      background: #fbbf24;
      padding: 2px 6px;
      border-radius: 6px;
      letter-spacing: .3px;
    }

    /* 新增新闻专区卡片 */
    .new-section{
      border-radius: var(--radius);
      border: 1px solid var(--glass-border);
      background: linear-gradient(180deg, rgba(255,255,255,0.48), rgba(255,255,255,0.35));
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      box-shadow: 0 6px 24px rgba(0,0,0,.06);
      padding: 14px;
      margin-top: 16px;
    }
    .new-title{
      font-size: 16px; font-weight: 900; color: var(--text-strong);
      margin-bottom: 10px;
    }
    .new-source{
      font-size: 13px; font-weight: 800; color: var(--text-muted);
      margin: 12px 0 6px;
      padding-bottom: 6px; border-bottom: 1px solid rgba(0,0,0,0.06);
    }
    .new-item{
      display: grid; grid-template-columns: 24px 40px 1fr; gap: 10px;
      padding: 8px 0; border-bottom: 1px solid rgba(0,0,0,0.05);
    }
    .new-item:last-child{ border-bottom: none; }
    .new-num{
      width: 20px; height: 20px; border-radius: 999px;
      display: flex; align-items: center; justify-content: center;
      font-size: 12px; font-weight: 800; color: var(--text-normal);
      background: rgba(15,23,42,.06);
      margin-top: 2px;
    }
    .new-rank{
      font-size: 11px; font-weight: 900; color: #111827;
      background: #e5e7eb; border-radius: 10px;
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 34px; height: 20px; padding: 0 6px;
    }
    .new-rank.top{ background: #fecaca; color: #991b1b; }
    .new-rank.high{ background: #fde68a; color: #92400e; }
    .new-text{
      font-size: 14px; color: var(--text-strong);
    }

    /* 错误块（请求失败平台） */
    .error-card{
      border-radius: var(--radius);
      border: 1px solid rgba(220,38,38,0.2);
      background: rgba(254,242,242,0.75);
      backdrop-filter: blur(calc(var(--blur) * .6));
      -webkit-backdrop-filter: blur(calc(var(--blur) * .6));
      padding: 12px 14px;
      color: #991b1b;
      margin: 16px 0;
    }
    .error-title{
      font-weight: 900; font-size: 14px; margin-bottom: 6px;
      color: #b91c1c;
    }
    .error-list{ margin: 0; padding-left: 18px; }
    .error-list li{ font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size: 12px; padding: 2px 0; }

    /* 页脚（简洁玻璃） */
    .footer{
      margin-top: 18px;
      border-radius: var(--radius);
      border: 1px solid var(--glass-border);
      background: linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.35));
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      padding: 14px;
      text-align: center;
      color: var(--text-muted);
      font-size: 13px;
    }
    .footer a{
      color: #374151; font-weight: 700; text-decoration: none;
    }
    .footer a:hover{ text-decoration: underline; }

    /* 响应式细节优化 */
    @media (max-width: 820px){
      .header-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (max-width: 560px){
      .nav-links{ display: none; }
      .nav-toggle{ display: inline-flex; margin-left: auto; }
      .header-grid{ grid-template-columns: 1fr 1fr; }
      .page-wrap{ padding-bottom: 26px; }
    }
  </style>
</head>
<body>
  <!-- 顶部导航 -->
  <nav class="navbar">
    <div class="nav-inner">
      <div class="brand">
        <span class="brand-mark"></span>
        TrendRadar
      </div>

      <div class="nav-spacer"></div>

      <div class="nav-links" aria-label="主导航">
        <a class="nav-link primary" href="https://news.nekobox.xyz" target="_self" rel="noopener">新闻</a>
        <a class="nav-link" href="https://jellyfin.nekobox.xyz" target="_blank" rel="noopener">影视库</a>
        <a class="nav-link" href="https://download.nekobox.xyz" target="_blank" rel="noopener">影视下载</a>
      </div>

      <button class="nav-toggle" aria-label="展开菜单" onclick="toggleMobileNav()">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="nav-mobile" id="navMobile">
      <a href="https://news.nekobox.xyz" target="_self" rel="noopener">新闻</a>
      <a href="https://jellyfin.nekobox.xyz" target="_blank" rel="noopener">影视库</a>
      <a href="https://download.nekobox.xyz" target="_blank" rel="noopener">影视下载</a>
    </div>
  </nav>

  <main class="page-wrap">
    <!-- 顶部信息卡+操作 -->
    <section class="header-card">
      <div class="header-top">
        <div class="title">热点新闻分析</div>
        <div class="badges">
          <!-- 这里保留两个示例徽章，实际文案由脚本填充 -->
          <span class="badge" id="reportType">加载中</span>
          <span class="badge" id="statsBadge">统计中</span>
        </div>
      </div>

      <div class="header-grid">
        <div class="info-box">
          <div class="info-label">报告类型</div>
          <div class="info-value" id="infoType">-</div>
        </div>
        <div class="info-box">
          <div class="info-label">新闻总数</div>
          <div class="info-value" id="infoTotal">-</div>
        </div>
        <div class="info-box">
          <div class="info-label">热点新闻</div>
          <div class="info-value" id="infoHot">-</div>
        </div>
        <div class="info-box">
          <div class="info-label">生成时间</div>
          <div class="info-value" id="infoTime">-</div>
        </div>
      </div>

      <div class="header-actions">
        <button class="btn" onclick="saveAsImage()">保存为图片</button>
        <button class="btn" onclick="saveAsMultipleImages()">分段保存</button>
      </div>
    </section>

    <!-- 错误卡（由脚本插入） -->
    <div id="errorHost"></div>

    <!-- 主题分组网格：宽屏并列，窄屏堆叠 -->
    <section class="content-grid" id="groupsHost">
      <!-- 这里由脚本把每个词组渲染为 group-card 并列显示 -->
    </section>

    <!-- 新增新闻区（由脚本插入） -->
    <section class="new-section" id="newSection" style="display:none">
      <div class="new-title" id="newTitleText">本次新增热点</div>
      <div id="newList"></div>
    </section>

    <footer class="footer">
      由 <strong>TrendRadar</strong> 生成 ·
      <a href="https://github.com/sansan0/TrendRadar" target="_blank" rel="noopener">GitHub 开源项目</a>
      <div id="updateInfo" style="margin-top:4px;"></div>
    </footer>
  </main>

  <script>
    // 简单移动端菜单开合
    function toggleMobileNav(){
      const el = document.getElementById('navMobile');
      if(!el) return;
      el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    // 以下脚本桥接原先 Python 生成的 HTML 内容逻辑：
    // 我们将通过“标记锚点”节点，把已有的内容段（错误列表、词组列表、新增列表、统计信息）插入到新的样式结构里。
    // 你可以在后端拼装时，保留与原先相同的文本片段，然后在这里定位并注入。

    // 页面加载后，从现有服务器端渲染的静态内容读取信息并填充
    document.addEventListener('DOMContentLoaded', function(){
      // 兼容：如果后端还是输出整段静态 HTML，可以用 data-* 或隐藏元素承载数值
      // 这里示例按你原始 render_html_content 中的信息来源映射：
      // 1. 报告类型、新闻总数、热点新闻数、生成时间
      try {
        // 直接扫描页面中现有的文本（若你继续后端生成整块 HTML，可在生成后再把对应文本塞进这些 id）
        const headerTextMaps = window.__TrendRadarHeader || {};
        // 若后端不提供全局对象，也可直接在后端写入以下四个元素的 innerText
        document.getElementById('infoType').innerText = headerTextMaps.type || document.querySelector('.header .header-title')?.innerText || '-';
        document.getElementById('infoTotal').innerText = headerTextMaps.total || '-';
        document.getElementById('infoHot').innerText = headerTextMaps.hot || '-';
        document.getElementById('infoTime').innerText = headerTextMaps.time || '-';

        // 同步徽章
        document.getElementById('reportType').innerText = headerTextMaps.type || '分析报告';
        document.getElementById('statsBadge').innerText = (headerTextMaps.hot ? ('热点 ' + headerTextMaps.hot) : '热点统计');
      } catch(e){}

      // 2. 将原有“请求失败的平台”列表注入 errorHost
      const failedBlock = document.querySelector('.error-section, .error-card-old');
      if(failedBlock){
        const host = document.getElementById('errorHost');
        // 将旧块内容重排为新卡片样式
        const errs = failedBlock.querySelectorAll('li');
        if(errs.length){
          const card = document.createElement('div');
          card.className = 'error-card';
          card.innerHTML = '<div class="error-title">⚠️ 请求失败的平台</div>';
          const ul = document.createElement('ul');
          ul.className = 'error-list';
          errs.forEach(li => {
            const item = document.createElement('li');
            item.textContent = li.textContent.trim();
            ul.appendChild(item);
          });
          card.appendChild(ul);
          host.appendChild(card);
        }
        // 隐藏旧块
        failedBlock.style.display = 'none';
      }

      // 3. 将原有每个词组与其内部新闻列表搬运成 group-card
      // 兼容旧结构：查找旧的 .word-group 容器
      const oldGroups = document.querySelectorAll('.word-group');
      const newHost = document.getElementById('groupsHost');
      if(oldGroups.length){
        oldGroups.forEach((g, idx) => {
          const head = g.querySelector('.word-header');
          const nameEl = g.querySelector('.word-name');
          const countEl = g.querySelector('.word-count');
          const indexEl = g.querySelector('.word-index');
          const items = g.querySelectorAll('.news-item');

          const card = document.createElement('div');
          card.className = 'group-card';

          // 头部
          const headDiv = document.createElement('div');
          headDiv.className = 'group-head';

          const left = document.createElement('div');
          left.className = 'group-title';

          const name = document.createElement('div');
          name.className = 'group-name';
          name.textContent = nameEl ? nameEl.textContent.trim() : ('主题 ' + (idx+1));

          const count = document.createElement('div');
          count.className = 'group-count';
          const rawCount = countEl ? countEl.textContent.trim() : '';
          count.textContent = rawCount || '0 条';
          // 根据数值加热度色
          const n = parseInt((rawCount||'0').replace(/\D+/g,'')||'0',10);
          if(n >= 10) count.classList.add('hot'); else if(n >= 5) count.classList.add('warm');

          left.appendChild(name);
          left.appendChild(count);

          const right = document.createElement('div');
          right.className = 'group-index';
          right.textContent = indexEl ? indexEl.textContent.trim() : ((idx+1) + '/' + oldGroups.length);

          headDiv.appendChild(left);
          headDiv.appendChild(right);
          card.appendChild(headDiv);

          // 列表
          items.forEach((item, i) => {
            const row = document.createElement('div');
            row.className = 'news-item';

            // 序号
            const num = document.createElement('div');
            num.className = 'news-number';
            num.textContent = (i+1).toString();
            row.appendChild(num);

            const content = document.createElement('div');

            // 元信息
            const meta = document.createElement('div');
            meta.className = 'news-meta';

            const sourceName = item.querySelector('.source-name');
            if(sourceName){
              const s = document.createElement('span');
              s.className = 'source';
              s.textContent = sourceName.textContent.trim();
              meta.appendChild(s);
            }

            // rank
            const rankSpan = item.querySelector('.rank-num');
            if(rankSpan){
              const r = document.createElement('span');
              r.className = 'rank-chip';
              const rankText = rankSpan.textContent.trim();
              r.textContent = rankText;
              if(rankSpan.classList.contains('top')) r.classList.add('top');
              else if(rankSpan.classList.contains('high')) r.classList.add('high');
              meta.appendChild(r);
            }

            // 时间
            const timeSpan = item.querySelector('.time-info');
            if(timeSpan){
              const t = document.createElement('span');
              t.className = 'time-chip';
              t.textContent = timeSpan.textContent.trim();
              meta.appendChild(t);
            }

            // 次数
            const countInfo = item.querySelector('.count-info');
            if(countInfo){
              const c = document.createElement('span');
              c.className = 'count-chip';
              c.textContent = countInfo.textContent.trim();
              meta.appendChild(c);
            }

            content.appendChild(meta);

            // 标题
            const titleDiv = document.createElement('div');
            titleDiv.className = 'news-title';
            const oldLink = item.querySelector('.news-link');
            if(oldLink){
              const a = document.createElement('a');
              a.className = 'news-link';
              a.href = oldLink.getAttribute('href');
              a.target = '_blank';
              a.rel = 'noopener';
              a.textContent = oldLink.textContent.trim();
              titleDiv.appendChild(a);
            }else{
              titleDiv.textContent = (item.querySelector('.news-title')?.textContent || '').trim();
            }
            content.appendChild(titleDiv);

            row.appendChild(content);

            // NEW
            if(item.classList.contains('new')){
              const tag = document.createElement('div');
              tag.className = 'tag-new';
              tag.textContent = 'NEW';
              row.appendChild(tag);
            }

            card.appendChild(row);
          });

          newHost.appendChild(card);

          // 隐藏旧组
          g.style.display = 'none';
        });
      }

      // 4. 新增新闻区搬运
      const oldNewSection = document.querySelector('.new-section');
      if(oldNewSection){
        // 读取文本汇总
        const title = document.getElementById('newTitleText');
        const summaryText = oldNewSection.querySelector('.new-section-title')?.textContent?.trim();
        if(summaryText) title.textContent = summaryText;

        const newListHost = document.getElementById('newList');
        const groups = oldNewSection.querySelectorAll('.new-source-group');
        if(groups.length){
          document.getElementById('newSection').style.display = 'block';
          groups.forEach(g => {
            const name = g.querySelector('.new-source-title')?.textContent?.trim() || '来源';
            const head = document.createElement('div');
            head.className = 'new-source';
            head.textContent = name;
            newListHost.appendChild(head);

            g.querySelectorAll('.new-item').forEach((item, i) => {
              const row = document.createElement('div');
              row.className = 'new-item';

              const num = document.createElement('div');
              num.className = 'new-num';
              num.textContent = (i+1).toString();

              const rank = document.createElement('div');
              const rankOld = item.querySelector('.new-item-rank');
              rank.className = 'new-rank';
              rank.textContent = rankOld?.textContent?.trim() || '?';
              if(rankOld?.classList.contains('top')) rank.classList.add('top');
              else if(rankOld?.classList.contains('high')) rank.classList.add('high');

              const txt = document.createElement('div');
              txt.className = 'new-text';
              const link = item.querySelector('a');
              if(link){
                const a = document.createElement('a');
                a.className = 'news-link';
                a.href = link.href;
                a.target = '_blank';
                a.rel = 'noopener';
                a.textContent = link.textContent.trim();
                txt.appendChild(a);
              }else{
                txt.textContent = (item.querySelector('.new-item-title')?.textContent || '').trim();
              }

              row.appendChild(num);
              row.appendChild(rank);
              row.appendChild(txt);
              newListHost.appendChild(row);
            });
          });

          // 隐藏旧新增段
          if(!oldNewSection.isSameNode(document.getElementById('newSection'))){
            oldNewSection.style.display = 'none';
          }
        }
      }

      // 5. 更新页脚版本提示（若后端有写）
      const updateInline = document.querySelector('.footer-content span[style*="ea580c"]');
      if(updateInline){
        document.getElementById('updateInfo').innerHTML = updateInline.innerHTML;
      }
    });

    // 保留原按钮函数：saveAsImage / saveAsMultipleImages
    async function saveAsImage() {
      const button = event.target;
      const originalText = button.textContent;

      try {
        button.textContent = '生成中...';
        button.disabled = true;
        window.scrollTo(0, 0);
        await new Promise(r => setTimeout(r, 200));

        // 截图时可隐藏导航
        const navbar = document.querySelector('.navbar');
        const toggle = document.querySelector('.nav-toggle');
        const navMobile = document.getElementById('navMobile');
        const oldDisplay = navMobile?.style.display;
        if(navMobile) navMobile.style.display = 'none';

        const canvas = await html2canvas(document.body, {
          backgroundColor: '#ffffff',
          scale: 1.5,
          useCORS: true,
          logging: false
        });

        if(navMobile) navMobile.style.display = oldDisplay || '';

        const link = document.createElement('a');
        const now = new Date();
        const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}_${String(now.getHours()).padStart(2,'0')}${String(now.getMinutes()).padStart(2,'0')}.png`;
        link.download = filename;
        link.href = canvas.toDataURL('image/png', 1.0);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        button.textContent = '保存成功!';
        setTimeout(()=>{ button.textContent = originalText; button.disabled = false; }, 1500);
      } catch (e){
        button.textContent = '保存失败';
        setTimeout(()=>{ button.textContent = originalText; button.disabled = false; }, 1500);
      }
    }

    async function saveAsMultipleImages() {
      // 这里沿用你原先的分段截图逻辑可行；为了简化，与新的布局结合，建议直接截图 body，或按 group-card 分段截图。
      // 若需要严格复刻原逻辑，可将原函数拷贝进来使用。
      const button = event.target;
      const originalText = button.textContent;
      button.textContent = '请使用单图保存或后续增强';
      setTimeout(()=> button.textContent = originalText, 1500);
    }
  </script>
</body>
</html>当日汇总</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">605 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">39 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">11-29 21:16</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">gemini deepmind chatgpt openai sora claude Anthropic DeepSeek 人工智能 AI</div>
                            <div class="word-count hot">34 条</div>
                        </div>
                        <div class="word-index">1/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Hacker News</span><span class="rank-num top">1</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ycombinator.com/item?id=46086624" target="_blank" class="news-link">High Air Pollution Could Diminish Exercise Benefits by 50%, Study Finds</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">V2EX</span><span class="rank-num top">3</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.v2ex.com/t/1175851" target="_blank" class="news-link">写文档必备，敖了三个夜写了的全新的 mermaidjs 编辑器，求体验跟点赞</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Hacker News</span><span class="rank-num high">4</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ycombinator.com/item?id=46086771" target="_blank" class="news-link">Leak confirms OpenAI is preparing ads on ChatGPT for public roll out</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">ProductHunt</span><span class="rank-num high">5</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.producthunt.com/products/gemini-6?utm_campaign=producthunt-api&amp;utm_medium=api-v2&amp;utm_source=Application%3A+newsnow+%28ID%3A+239216%29" target="_blank" class="news-link">Gemini 3</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Hacker News</span><span class="rank-num ">6</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ycombinator.com/item?id=46083004" target="_blank" class="news-link">Airbus A320 – intense solar radiation may corrupt data critical for flight</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">虫部落</span><span class="rank-num ">6</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.chongbuluo.com/thread-23169-1-1.html" target="_blank" class="news-link">不能魔法怎么用 ChatGPT？代理可接受，但总跑路，有没有可靠的？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num ">7</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/901/271.htm" target="_blank" class="news-link">5A 先进通信技术外显：华为 Mate 70 Air 手机获鸿蒙 HarmonyOS 6.0.0.115 SP6 升级</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Solidot</span><span class="rank-num ">9</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.solidot.org/story?sid=82906" target="_blank" class="news-link">AI 撰写了哪些类型的文章</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">GitHub</span><span class="rank-num ">10</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://github.com/GibsonAI/Memori" target="_blank" class="news-link">GibsonAI / Memori</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">远景论坛</span><span class="rank-num ">11</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://bbs.pcbeta.com/viewthread-2058538-1-1.html" target="_blank" class="news-link">借地方问一下，夸克的这个AI划词工具 怎么关？</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">高市早苗 特朗普 外交部 国防部</div>
                            <div class="word-count hot">14 条</div>
                        </div>
                        <div class="word-index">2/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num top">1</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068619725.html" target="_blank" class="news-link">特朗普宣布委内瑞拉上空及周边空域全部关闭</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num ">8</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068618848.html" target="_blank" class="news-link">巴基斯坦外交部：与阿富汗的停火机制未得到遵守</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num ">9</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068618736.html" target="_blank" class="news-link">俄国防部：俄军袭击乌军用机场基础设施、无人机存储地和发射场</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num ">10</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068618504.html" target="_blank" class="news-link">俄国防部：俄武装力量大规模打击乌克兰军工综合体回应其对民用设施的袭击</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num ">14</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068617875.html" target="_blank" class="news-link">俄国防部：俄防空系统昨夜在俄11个地区和亚速海上空击落103架乌无人机</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">联合早报</span><span class="rank-num ">15</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zaochenbao.com/news/Chronicles/202511/2958556.html" target="_blank" class="news-link">日程减少、体重减轻：特朗普的衰老与健康疑云</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">16</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_32064050" target="_blank" class="news-link">大外交丨极限施压委内瑞拉、拉拢拉美右翼，特朗普式“门罗主义”笼罩拉美</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">卫星通讯社</span><span class="rank-num ">16</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://sputniknews.cn/20251129/1068617776.html" target="_blank" class="news-link">俄国防部：俄空降兵在扎波罗热州歼灭一个乌军轮换小组</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">参考消息</span><span class="rank-num ">17</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://ckxxapp.ckxx.net/pages/2025/11/29/52884993b55e457ca3810f6cf830be64.html" target="_blank" class="news-link">美媒：特朗普与马杜罗通电话，并商定举行会晤</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">联合早报</span><span class="rank-num ">17</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zaochenbao.com/news/politics/202511/2958554.html" target="_blank" class="news-link">面对特朗普和平方案，泽连斯基能否再次力挽狂澜？</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">微软 Microsoft 英特尔 Intel 谷歌 google</div>
                            <div class="word-count warm">7 条</div>
                        </div>
                        <div class="word-index">3/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">GitHub</span><span class="rank-num top">2</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://github.com/google/adk-go" target="_blank" class="news-link">google / adk-go</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">远景论坛</span><span class="rank-num top">3</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://bbs.pcbeta.com/viewthread-2058557-1-1.html" target="_blank" class="news-link">微软输入法可以取消数字小键盘选词吗</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">GitHub</span><span class="rank-num ">12</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://github.com/microsoft/call-center-ai" target="_blank" class="news-link">microsoft / call-center-ai</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">远景论坛</span><span class="rank-num ">14</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://bbs.pcbeta.com/viewthread-2058521-1-1.html" target="_blank" class="news-link">微软承认Win11新BUG：锁屏密码登录图标“消失”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">远景论坛</span><span class="rank-num ">17</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://bbs.pcbeta.com/viewthread-2058516-1-1.html" target="_blank" class="news-link">微软承认 Win11 新 BUG：锁屏密码登录图标“消失”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">ProductHunt</span><span class="rank-num ">17</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.producthunt.com/products/google-antigravity?utm_campaign=producthunt-api&amp;utm_medium=api-v2&amp;utm_source=Application%3A+newsnow+%28ID%3A+239216%29" target="_blank" class="news-link">Google Antigravity</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">ProductHunt</span><span class="rank-num ">19</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.producthunt.com/products/google-nano-banana-pro?utm_campaign=producthunt-api&amp;utm_medium=api-v2&amp;utm_source=Application%3A+newsnow+%28ID%3A+239216%29" target="_blank" class="news-link">Google Nano Banana Pro</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">Python Javascript Vue React C\+\+ 编程语言 Cpp C语言 Rust</div>
                            <div class="word-count warm">6 条</div>
                        </div>
                        <div class="word-index">4/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">掘金</span><span class="rank-num high">5</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://juejin.cn/post/7577594229413756947" target="_blank" class="news-link">黑马喽大闹天宫与JavaScript的寻亲记：作用域与作用域链全解析</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">ProductHunt</span><span class="rank-num ">6</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.producthunt.com/products/trustmrr/launches/trustmrr?utm_campaign=producthunt-api&amp;utm_medium=api-v2&amp;utm_source=Application%3A+newsnow+%28ID%3A+239216%29" target="_blank" class="news-link">TrustMRR</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">掘金</span><span class="rank-num ">12</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://juejin.cn/post/7577364921657049130" target="_blank" class="news-link">作用域链 × 闭包：三段代码，看懂 JavaScript 的套娃人生</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Hacker News</span><span class="rank-num ">23</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ycombinator.com/item?id=46082204" target="_blank" class="news-link">The original ABC language, Python&#x27;s predecessor (1991)</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">掘金</span><span class="rank-num ">25</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://juejin.cn/post/7576867727719677987" target="_blank" class="news-link">10分钟搞定！SpringBoot+Vue3 整合 SSE 实现实时消息推送</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">掘金</span><span class="rank-num ">29</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://juejin.cn/post/7577295460248944686" target="_blank" class="news-link">JavaScript 词法作用域、作用域链与闭包：从代码看机制</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">英伟达 NVIDIA 黄仁勋 AMD</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">5/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num ">19</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/901/240.htm" target="_blank" class="news-link">AYANEO 全新 Windows 掌机 NEXT II 发布：AMD 锐龙 AI Max+ 395、115Wh 电池</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">远景论坛</span><span class="rank-num ">19</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://bbs.pcbeta.com/viewthread-2058512-1-1.html" target="_blank" class="news-link">英伟达驱动595.02</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">马斯克 火箭回收 月球 登月 火星 宇宙 飞船 航空 nasa</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">6/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">Solidot</span><span class="rank-num ">6</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.solidot.org/story?sid=82909" target="_blank" class="news-link">NASA 漫游车在火星上发现闪电</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">15</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ifeng.com/c/8ofi9WpZxoW" target="_blank" class="news-link">日媒：中国航空公司12月要取消超900架次赴日航班</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">大伟哥 刘伟 蔡浩宇 蔡喵 mihoyo 米哈游 varsapura 米哈游+鹿鸣 林离Olivia 米哈游+林离 米哈游+崩坏 honkai 星穹铁道 星铁 崩铁 原神 genshin 绝区零 zenless zone zero 星布谷地 因缘精灵 米哈游+新作</div>
                            <div class="word-count ">2 条</div>
                        </div>
                        <div class="word-index">7/7</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">6</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E5%B4%A9%E9%93%81%E5%8A%A8%E7%94%BB%E7%9F%AD%E7%89%87" target="_blank" class="news-link">崩铁动画短片 翁法罗斯边境</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">IT之家</span><span class="rank-num ">20</span><span class="time-info">21时12分~21时16分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.ithome.com/0/901/239.htm" target="_blank" class="news-link">一加 × 原神达成战略合作，率先搭载 GSS 游戏状态通讯技术</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    